<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>New Event Record</title>
<style>
  /* === 核心樣式：暗黑科技風 === */
  body {
    margin: 0;
    padding: 20px;
    font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
    background: radial-gradient(circle at top, #1e293b, #020617);
    color: #e5e7eb;
    height: 100vh;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
  }

  h1 {
    text-align: center;
    color: #4ade80;
    margin: 0 0 20px 0;
    font-size: 32px;
    text-shadow: 0 0 10px rgba(74, 222, 128, 0.3);
  }

  /* === 排版系統 === */
  .layout-grid {
    display: grid;
    /* 左側(240px) | 中間(自動) | 右側(140px) */
    grid-template-columns: 240px 1fr 140px;
    grid-template-rows: auto 1fr;
    gap: 15px;
    flex: 1;
    min-height: 0;
  }

  .field-group {
    display: flex;
    flex-direction: column;
    margin-bottom: 12px;
  }

  label {
    display: block;
    margin-bottom: 6px;
    color: #fb923c; /* Orange */
    font-size: 16px;
    font-weight: bold;
  }

  input, select, textarea {
    padding: 10px;
    font-size: 16px;
    border-radius: 8px;
    border: 1px solid rgba(148, 163, 184, 0.25);
    background: #020617;
    color: #38bdf8;
    width: 100%;
    box-sizing: border-box;
    outline: none;
    transition: border 0.3s;
  }

  input:focus, select:focus, textarea:focus {
    border-color: #38bdf8;
    box-shadow: 0 0 8px rgba(56, 189, 248, 0.2);
  }

  /* === 特殊區塊設定 === */

  /* 中間上方的橫排區域 (現在只放 Title) */
  .center-top-row {
    grid-column: 2 / 3;
    grid-row: 1 / 2;
    display: flex;
    /* 因為只剩一個元素，讓它自動填滿 */
  }

  /* 中間主要的描述區 */
  .center-main-area {
    grid-column: 2 / 3;
    grid-row: 2 / 3;
    display: flex;
    flex-direction: column;
  }

  .center-main-area textarea {
    flex: 1;
    resize: none;
    font-size: 18px;
    line-height: 1.5;
  }

  /* 右側附件區 */
  .right-sidebar {
    grid-column: 3 / 4;
    grid-row: 1 / 3;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .appendix-box {
    height: 80px;
    border: 1px dashed rgba(148, 163, 184, 0.4);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #64748b;
    font-size: 12px;
    background: rgba(2, 6, 23, 0.5);
  }

  /* 左側邊欄 */
  .left-sidebar {
    grid-column: 1 / 2;
    grid-row: 1 / 3;
    display: flex;
    flex-direction: column;
  }

  /* 按鈕區 */
  .btn-container {
    margin-top: auto;
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .btn {
    width: 100%;
    padding: 15px;
    font-size: 20px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    font-weight: bold;
    transition: transform 0.1s;
  }
  .btn:active { transform: scale(0.98); }

  .btn-save { background: #16a34a; color: #fff; }
  .btn-exit { background: #1e293b; color: #94a3b8; border: 1px solid #334155; }

</style>
</head>
<body>

  <h1>New Event Record</h1>

  <div class="layout-grid">
    
    <div class="left-sidebar">
      
      <div class="field-group">
        <label>Event Date *</label>
        <input id="eventDate" readonly>
      </div>

      <div class="field-group">
        <label>Customer *</label>
        <select id="customer">
          <option value="">-- Select --</option>
          <option>TSMC</option>
          <option>UMC</option>
          <option>VIS</option>
		  <option>EZ TECH</option>
          <option>OTHER</option>
        </select>
      </div>

      <div class="field-group">
        <label>Machine *</label>
        <input id="machine">
      </div>
      <div class="field-group">
        <label>Engineer *</label>
        <input id="engineer">
      </div>

      <div class="btn-container">
        <button class="btn btn-save" onclick="saveEvent()">Create Event</button>
        <button class="btn btn-exit" onclick="location.href='Record System.html'">Exit</button>
      </div>
    </div>

    <div class="center-top-row">
      <div class="field-group" style="width: 100%;"> <label>Event Title *</label>
        <input id="eventTitle">
      </div>
    </div>

    <div class="center-main-area">
      <label>Process Describe *</label>
      <textarea id="processDescribe"></textarea>
    </div>

    <div class="right-sidebar">
      <label>Appendix</label>
      <div class="appendix-box">File 1</div>
      <div class="appendix-box">File 2</div>
      <div class="appendix-box">File 3</div>
      <div class="appendix-box">File 4</div>
    </div>

  </div>

<script>
// GAS 網址 (維持不變)
const API_URL = 'https://script.google.com/macros/s/AKfycbw3f4ch9YxN47QQ_Sa9vuTKk5-Y9yLJumm4wkozjWkxcMqiW9fAhLBxI2Lvd64DRrqn/exec';

/* Init Date */
const today = new Date().toISOString().slice(0,10).replace(/-/g,'/');
document.getElementById('eventDate').value = today;

/* Save Event */
function saveEvent(){

  const eventDate = document.getElementById('eventDate');
  const eventTitle = document.getElementById('eventTitle');
  const customer = document.getElementById('customer');
  const machine = document.getElementById('machine'); // 記得這現在是在左側抓取
  const engineer = document.getElementById('engineer');
  const processDescribe = document.getElementById('processDescribe');

  if(
    !eventDate.value ||
    !eventTitle.value.trim() ||
    !customer.value ||
    !machine.value.trim() ||
    !engineer.value.trim() ||
    !processDescribe.value.trim()
  ){
    alert('❌ All fields are required');
    return;
  }

  const payload = {
    mode: 'createEvent',
    EventDate: eventDate.value,
    EventTitle: eventTitle.value.trim(),
    Customer: customer.value,
    Machine: machine.value.trim(),
    Engineer: engineer.value.trim(),
    ProcessDescribe: processDescribe.value.trim(),
    MaintainDate: eventDate.value
  };

  fetch(API_URL, {
    method: 'POST',
    body: JSON.stringify(payload)
  })
  .then(r => r.json())
  .then(res => {
    if(res.result === 'OK'){
      alert('✅ Event created');
      location.href = 'Record System.html';
    } else {
      alert(res.message || 'Create failed');
    }
  })
  .catch(err => {
    alert('GAS connection error');
    console.error('詳細錯誤:', err);
  });
}
</script>

</body>
</html>